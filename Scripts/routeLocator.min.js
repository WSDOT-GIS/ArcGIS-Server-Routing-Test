require(["dojo/on","esri/urlUtils","esri/map","esri/geometry/Point","esri/layers/GraphicsLayer","esri/tasks/RouteTask","esri/renderers/SimpleRenderer","esri/symbols/SimpleMarkerSymbol","esri/symbols/SimpleLineSymbol","esri/graphic","esri/InfoTemplate","esri/dijit/Basemap","esri/dijit/BasemapLayer","esri/layers/ArcGISDynamicMapServiceLayer","esri/tasks/RouteParameters","esri/tasks/FeatureSet","esri/units","dojo/_base/connect","wsdot/tasks/intersectionLocator","esri/dijit/Attribution"],function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k){"use strict";function ot(n){var i=[],t;return n&&n.address&&(t=n.address,i.push(t.Address,", "),i.push(t.City,", ",t.Region,"  ",t.Postal)),i.join("")}function ut(){var n=document.getElementById("deleteButton"),t=document.getElementById("clearButton");n.disabled=t.disabled=!(d.graphics.length>0||nt.graphics.length>0)}function ft(n){var t=null;return n.graphics.length>0&&(t=n.graphics[n.graphics.length-1],n.remove(t)),t}function et(n){var t=n.target.id;d.graphics.length>0?t==="clearButton"?d.clear():ft(d):nt.graphics.length>0&&(t==="clearButton"?nt.clear():ft(nt))}var g,it,rt,d,nt,tt;tt=window.location.protocol;document.getElementById("deleteButton").addEventListener("click",et);document.getElementById("clearButton").addEventListener("click",et);t.addProxyRule({proxyUrl:"proxy.ashx",urlPrefix:tt+"//route.arcgis.com"});g=new i("map",{basemap:new l({id:"Hybrid",layers:[new a({url:tt+"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer"}),new a({url:tt+"//services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Transportation/MapServer"}),new a({url:tt+"//services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer"})]}),center:[-120.80566406246835,47.413220330159461],zoom:7,showAttribution:!0});b.connect(g,"onUpdateStart",function(){document.getElementById("mapProgress").hidden=!1});b.connect(g,"onUpdateEnd",function(){document.getElementById("mapProgress").hidden=!0});g.on("load",function(){var n;navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(n){var t,i;t=n.coords.longitude;i=n.coords.latitude;g.centerAndZoom(new r(t,i),15)},function(n){window.console.error(n)});g.disableDoubleClickZoom();d=new u({id:"stops"});d.setInfoTemplate(new c("Address","${Name}"));n=new o;n.setColor("00ccff");d.setRenderer(new e(n));g.addLayer(d);nt=new u({id:"routes"});nt.setInfoTemplate(new c("Route","${Name}"));n=new s;n.setColor("00ccff");n.setWidth(10);nt.setRenderer(new e(n));g.addLayer(nt);[d,nt].forEach(function(n){n.on("graphic-add",ut);n.on("graphic-remove",ut)});it=new k(tt+"ReverseGeocodeIntersection.ashx");it.setOutSpatialReference(g.spatialReference);rt=new f(tt+"//route.arcgis.com/arcgis/rest/services/World/Route/NAServer/Route_World");g.on("click",function(n){n.mapPoint&&it.locationToIntersection(n.mapPoint,10,function(n){var t=new h;t.setGeometry(n.location);t.setAttributes({Name:ot(n)});d.add(t)},function(n){window.console.error(n)})});g.on("dbl-click",function(n){if(n.mapPoint&&d.graphics.length>=2){var t,i;i=new p;i.features=d.graphics;t=new y;t.stops=i;t.returnRoutes=!0;t.returnDirections=!1;t.directionsLengthUnits=w.MILES;t.outSpatialReference=g.spatialReference;t.restrictionAttributes=["none"];rt.solve(t,function(n){var t,i;if(n&&n.routeResults&&n.routeResults.length)for(t=0,i=n.routeResults.length;t<i;t+=1)nt.add(n.routeResults[t].route);d.clear();window.console.log(n)},t,function(n){window.console.error(n)})}})})});
/*
//# sourceMappingURL=routeLocator.min.js.map
*/